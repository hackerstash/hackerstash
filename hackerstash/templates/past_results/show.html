{% extends 'base_app.html' %}
{% set title = 'HackerStash / Past Results' %}

{% from "partials/previews.html" import project_preview %}

{% block body %}
    <div class="page past-results result">
        <header class="header result-header mb-0">
            <h2 role="heading">
                Past Results
                <span>{{ contest.start_date | to_contest_date }} -> {{ contest.end_date | to_contest_date }}</span>
            </h2>
            <a href="{{ url_for('past_results.index') }}" class="button secondary has-icon">
                <i class="ri-arrow-left-line"></i>
                Back
            </a>
        </header>

        <div class="message warning" role="alert">
            <i class="ri-error-warning-line"></i>
            <p><b>Please note:</b> you are viewing the leaderboard from a closed tournament. <a aria-label="View the current tournament" href="{{ url_for('leaderboard.index') }}">Click here</a> to visit the live leaderboard</p>
        </div>

        <div class="table">
            <div class="table-header">
                <p class="col-1">Rank</p>
                <p class="col-4">Project name</p>
                <p class="col-4">Url</p>
                <p class="col-3">Score</p>
            </div>
            <ul class="table-body" role="list">
                {% for past_result in contest.past_results %}
                    <li role="listitem">
                        <p class="col-1 position">
                            <span>{{ past_result.position }}</span>
                        </p>
                        <p class="col-4 project">
                            {% if past_result.project %}
                                {{ project_preview(past_result.project) }}
                            {% else %}
                                <b>Project deleted</b>
                            {% endif %}
                        </p>
                        <p class="col-4 small">
                            {% if past_result.project and past_result.project.url %}
                                <a href="{{ past_result.project.url if past_result.project.url.startswith('http') else '//' + past_result.project.url }}" target="_blank" rel="nofollow noreferrer" aria-label="View the {{ past_result.project.name }} website">
                                    {{ past_result.project.url | to_nice_url }}
                                </a>
                            {% endif %}
                        </p>
                        <p class="col-3 small score">
                            <i>{{ past_result.score }} points</i>
                        </p>
                    </li>
                {% else %}
                    {% include "partials/no_results.html" %}
                {% endfor %}
            </ul>
        </div>
    </div>
{% endblock %}